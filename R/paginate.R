#' Return next request (if existing) from a Megamation API response
#'
#' `mm_next_req()` returns the next request based on the next_url given
#' by the parsed response.
#' @param resp An API response.
#' @param req An API request generated by [mm_request()].
#' @returns An object of class `httr2_request` or `NULL`.
#' @export
#' @examples
#' \dontrun{
#' mm_request("workorder") |>
#'   httr2::req_perform_iterative(
#'     next_req = function(resp, req) mm_next_req(resp, req)
#'     )
#' }
mm_next_req <- function(resp, req) {
  parsed <- resp |> mm_resp_parse()
  url <- parsed$next_page
  if (is.null(url) || url == "") {
    return(NULL)
  }
  signal_total_pages(mm_n_pages(parsed))
  req$url <- url
  return(req)
}
